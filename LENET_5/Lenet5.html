<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/303244 (en-US, DDL); Windows/5.1.2600 Service Pack 3 (Win32);"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="797"/>

<div>
<span><div><span style="font-size: 16px;">LeNet. The first successful applications of Convolutional Networks were developed by Yann LeCun in 1990’s. Of these, the best known is the LeNet architecture that was used to read zip codes, digits, etc.</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;"><a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf">http://yann.lecun.com/exdb/publis/pdf/lecun-98.pdf</a></span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">Main Moments </span></div><div><span style="font-size: 16px;"><img src="Lenet5_files/Image.png" type="image/png" style="height: auto;"/></span></div><div><span style="font-size: 16px;"><br/></span></div><ol><li><span style="font-size: 16px;"> The input image is 32x32 pixel image , this is larger than the largest character in database  (at most 20x20 pixels centered in 28x28)</span><ol><li><span style="font-size: 16px;">Reason : it s desirable that potential disictive features such as stroke end-points or corner can appear in the center of the receptive field of the highest level feature detector</span></li></ol></li><li><span style="font-size: 16px;">Normalization: the values of the imput pixels are normilized so that the background level (white) corresponds to a value of -0.1 and the foreground (black) corresponds to 1.175</span><ol><li><span style="font-size: 16px;">This makes the mean input rougly 0, and  the variance rougly 1 which accelerates learning. </span></li></ol></li><li><span style="font-size: 16px;">Parameters :</span><ol><li><span style="font-size: 16px;">Cx - convolutional layers</span></li><li><span style="font-size: 16px;">Sx - subsampling layers </span></li><li><span style="font-size: 16px;">Fx - fully connected layer</span></li></ol></li><li><font size="4">Participially connection between layers </font><ol><li><font size="4">Layer C3 is convolution layer with 16 feature maps. Each unit in each feature map is connected to several 5x5 neighborhoods as identical locations in a SUBSET of S2's feature maps.  </font><img src="Lenet5_files/Image [1].png" type="image/png" style="height: auto;"/></li><li><span style="font-size: 16px;">Reason : </span><ol><li><span style="font-size: 16px;">First : a non complete connection scheme keeps the number of connections within reasonable bounds.</span></li><li><span style="font-size: 16px;">Second : It forces a break of symmetry in he net work. </span></li></ol></li></ol></li><li><span style="font-size: 16px;">Output layer is composed of Euclidean Radial Basis Functions units </span></li><li><span style="font-size: 16px;">Results on mnist dataset </span><ol><li><span style="font-size: 16px;">after 10 passes through the traing set the error  is 0.95%</span></li><li><span style="font-size: 16px;">after 19 passes 0.35%</span></li></ol></li></ol><div><br/></div><div><font size="4">I. Cause I do not know how to make particial connection we may change it to dropuot at the level of 50%.. cause as it folows from the table approximatelly 50% elements are connected . Moreover I could find several  examples of LeNet 5 and non of them has participially connected layers </font></div><ul><li><span style="font-size: 16px;"><a href="https://github.com/nihit/TensorFlow101/blob/master/mnist.py">https://github.com/nihit/TensorFlow101/blob/master/mnist.py</a></span></li><li><span style="font-size: 16px;"><a href="http://pastebin.com/p4KDZ0kt">http://pastebin.com/p4KDZ0kt</a></span></li><li><span style="font-size: 16px;"><a href="https://ml4a.github.io/guides/convolutional_neural_networks/">https://ml4a.github.io/guides/convolutional_neural_networks/</a></span></li><li><span style="font-size: 16px;"><a href="http://ankivil.com/mnist-database-and-simple-classification-networks/">http://ankivil.com/mnist-database-and-simple-classification-networks/</a></span></li></ul><div><span style="font-size: 16px;">II Proposed variation of Lenet 5 </span></div><ul><li><span style="font-size: 16px;">Data preporation</span></li></ul><div><span style="font-size: 16px;">          (X_train, y_train), (X_test, y_test) = mnist.load_data()</span></div><div><span style="font-size: 16px;">          X_train = X_train.reshape(X_train.shape[0], 1, 28, 28).astype('float32') / 255</span></div><div><span style="font-size: 16px;">          X_test = X_test.reshape(X_test.shape[0], 1, 28, 28).astype('float32') / 255</span></div><div><span style="font-size: 16px;">          Y_train = np_utils.to_categorical(y_train, 10)</span></div><div><span style="font-size: 16px;">          Y_test = np_utils.to_categorical(y_test, 10)</span></div><div><span style="font-size: 16px;">          ('X_train shape:', (60000, 1, 28, 28))</span></div><div><span style="font-size: 16px;">          (60000, 'train samples')</span></div><div><span style="font-size: 16px;">          (10000, 'test samples')</span></div><div><span style="font-size: 16px;">          Train on 60000 samples, validate on 10000 samples</span></div><ul><li><span style="font-size: 16px;">Model</span></li></ul><div><img src="Lenet5_files/Image [2].png" type="image/png" style="height: auto;"/></div><div><img src="Lenet5_files/Image [3].png" type="image/png" style="height: auto;"/></div><ul><li><span style="font-size: 16px;">Model Performance </span></li></ul><div><span style="font-size: 16px;">Epoch 1/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.3493 - acc: 0.8924 - val_loss: 0.0842 - val_acc: 0.9731</span></div><div><span style="font-size: 16px;">Epoch 2/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.1249 - acc: 0.9625 - val_loss: 0.0579 - val_acc: 0.9823</span></div><div><span style="font-size: 16px;">Epoch 3/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0981 - acc: 0.9710 - val_loss: 0.0494 - val_acc: 0.9832</span></div><div><span style="font-size: 16px;">Epoch 4/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0858 - acc: 0.9743 - val_loss: 0.0442 - val_acc: 0.9847</span></div><div><span style="font-size: 16px;">Epoch 5/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0736 - acc: 0.9785 - val_loss: 0.0382 - val_acc: 0.9863</span></div><div><span style="font-size: 16px;">Epoch 6/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0653 - acc: 0.9806 - val_loss: 0.0352 - val_acc: 0.9875</span></div><div><span style="font-size: 16px;">Epoch 7/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0608 - acc: 0.9819 - val_loss: 0.0346 - val_acc: 0.9884</span></div><div><span style="font-size: 16px;">Epoch 8/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0564 - acc: 0.9828 - val_loss: 0.0328 - val_acc: 0.9884</span></div><div><span style="font-size: 16px;">Epoch 9/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0533 - acc: 0.9835 - val_loss: 0.0314 - val_acc: 0.9886</span></div><div><span style="font-size: 16px;">Epoch 10/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0505 - acc: 0.9854 - val_loss: 0.0306 - val_acc: 0.9896</span></div><div><span style="font-size: 16px;">Epoch 11/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0474 - acc: 0.9856 - val_loss: 0.0297 - val_acc: 0.9893</span></div><div><span style="font-size: 16px;">Epoch 12/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0447 - acc: 0.9868 - val_loss: 0.0282 - val_acc: 0.9907</span></div><div><span style="font-size: 16px;">Epoch 13/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0422 - acc: 0.9871 - val_loss: 0.0272 - val_acc: 0.9910</span></div><div><span style="font-size: 16px;">Epoch 14/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0406 - acc: 0.9884 - val_loss: 0.0281 - val_acc: 0.9896</span></div><div><span style="font-size: 16px;">Epoch 15/15</span></div><div><span style="font-size: 16px;">60000/60000 [==============================] - 17s - loss: 0.0399 - acc: 0.9876 - val_loss: 0.0279 - val_acc: 0.9905</span></div><div><span style="font-size: 16px;">('Test score:', 0.027922185424105555)</span></div><div><span style="font-size: 16px;">('Test accuracy:', 0.99050000000000005)</span></div><ul><li><span style="font-size: 16px;">Model Structure </span></li></ul><div><span style="font-size: 16px;">modelL5.h5 contains:</span></div><div><span style="font-size: 16px;">Root attributes:</span></div><div><span style="font-size: 16px;">  layer_names: ['convolution2d_8' 'activation_13' 'convolution2d_9' 'activation_14'</span></div><div><span style="font-size: 16px;"> 'maxpooling2d_5' 'dropout_6' 'flatten_4' 'dense_7' 'activation_15'</span></div><div><span style="font-size: 16px;"> 'dropout_7' 'dense_8' 'activation_16']</span></div><div><span style="font-size: 16px;">  activation_13</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  activation_14</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  activation_15</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  activation_16</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  convolution2d_8</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: ['convolution2d_8_W:0' 'convolution2d_8_b:0']</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">      convolution2d_8_W:0: (32, 1, 3, 3)</span></div><div><span style="font-size: 16px;">      convolution2d_8_b:0: (32,)</span></div><div><span style="font-size: 16px;">  convolution2d_9</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: ['convolution2d_9_W:0' 'convolution2d_9_b:0']</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">      convolution2d_9_W:0: (32, 32, 3, 3)</span></div><div><span style="font-size: 16px;">      convolution2d_9_b:0: (32,)</span></div><div><span style="font-size: 16px;">  dense_7</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: ['dense_7_W:0' 'dense_7_b:0']</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">      dense_7_W:0: (4608, 128)</span></div><div><span style="font-size: 16px;">      dense_7_b:0: (128,)</span></div><div><span style="font-size: 16px;">  dense_8</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: ['dense_8_W:0' 'dense_8_b:0']</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">      dense_8_W:0: (128, 10)</span></div><div><span style="font-size: 16px;">      dense_8_b:0: (10,)</span></div><div><span style="font-size: 16px;">  dropout_6</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  dropout_7</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  flatten_4</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;">  maxpooling2d_5</span></div><div><span style="font-size: 16px;">    Attributes:</span></div><div><span style="font-size: 16px;">      weight_names: []</span></div><div><span style="font-size: 16px;">    Dataset:</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Convolution2D', 'config': {'b_regularizer': None, 'W_constraint': None, 'b_constraint': None, 'name': 'convolution2d_8', 'activity_regularizer': None, 'trainable': True, 'dim_ordering': 'th', 'nb_col': 3, 'subsample': (1, 1), 'init': 'glorot_uniform', 'bias': True, 'nb_filter': 32, 'input_dtype': 'float32', 'border_mode': 'valid', 'batch_input_shape': (None, 1, 28, 28), 'W_regularizer': None, 'activation': 'linear', 'nb_row': 3}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Activation', 'config': {'activation': 'relu', 'trainable': True, 'name': 'activation_13'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Convolution2D', 'config': {'W_constraint': None, 'b_constraint': None, 'name': 'convolution2d_9', 'activity_regularizer': None, 'trainable': True, 'dim_ordering': 'th', 'nb_col': 3, 'subsample': (1, 1), 'init': 'glorot_uniform', 'bias': True, 'nb_filter': 32, 'border_mode': 'valid', 'b_regularizer': None, 'W_regularizer': None, 'activation': 'linear', 'nb_row': 3}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Activation', 'config': {'activation': 'relu', 'trainable': True, 'name': 'activation_14'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'MaxPooling2D', 'config': {'name': 'maxpooling2d_5', 'trainable': True, 'dim_ordering': 'th', 'pool_size': (2, 2), 'strides': (2, 2), 'border_mode': 'valid'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Dropout', 'config': {'p': 0.25, 'trainable': True, 'name': 'dropout_6'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Flatten', 'config': {'trainable': True, 'name': 'flatten_4'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Dense', 'config': {'W_constraint': None, 'b_constraint': None, 'name': 'dense_7', 'activity_regularizer': None, 'trainable': True, 'init': 'glorot_uniform', 'bias': True, 'input_dim': None, 'b_regularizer': None, 'W_regularizer': None, 'activation': 'linear', 'output_dim': 128}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Activation', 'config': {'activation': 'relu', 'trainable': True, 'name': 'activation_15'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Dropout', 'config': {'p': 0.5, 'trainable': True, 'name': 'dropout_7'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Dense', 'config': {'W_constraint': None, 'b_constraint': None, 'name': 'dense_8', 'activity_regularizer': None, 'trainable': True, 'init': 'glorot_uniform', 'bias': True, 'input_dim': None, 'b_regularizer': None, 'W_regularizer': None, 'activation': 'linear', 'output_dim': 10}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">{'class_name': 'Activation', 'config': {'activation': 'softmax', 'trainable': True, 'name': 'activation_16'}}</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">4 (32, 1, 3, 3)</span></div><div><span style="font-size: 16px;">9</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">1 (32,)</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">4 (32, 32, 3, 3)</span></div><div><span style="font-size: 16px;">288</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">1 (32,)</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">2 (4608, 128)</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">1 (128,)</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">2 (128, 10)</span></div><div><span style="font-size: 16px;">--------------</span></div><div><span style="font-size: 16px;">1 (10,)</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;">Model files : modelL5.h5</span></div><div><span style="font-size: 16px;">weightsL5_1.csv</span></div><div><span style="font-size: 16px;">weightsL5_2.csv - bias</span></div><div><span style="font-size: 16px;">weightsL5_3.csv</span></div><div><span style="font-size: 16px;">weightsL5_4.csv</span><span style="font-size: 16px;">- bias</span></div><div><span style="font-size: 16px;">weightsL5_5.csv</span></div><div><span style="font-size: 16px;">weightsL5_6.csv</span><span style="font-size: 16px;">- bias</span></div><div><span style="font-size: 16px;">weightsL5_7.csv</span></div><div><span style="font-size: 16px;">weightsL5_8.csv</span><span style="font-size: 16px;">- bias</span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;"><br/></span></div><div><span style="font-size: 16px;"><br/></span></div></span>
</div></body></html> 